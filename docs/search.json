[{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"PICtR: Physically Interacting Cell toolkit for R","text":"Many fundamental processes life shaped physical interactions cells. PICtR provides computational workflow analyse cellular landscapes cellular interactions high-dimensional flow cytometry data using R. PICtR can used cytometry-based assay approach can also applied existing datasets, provided following guidelines met: data stems case-control setting samples treated sample processing acquisition, e.g. regarding equal cell concentrations, incubation times, flow rates Pooling across conditions, organs donors avoided vivo experiments, cells strong affinity interact can artificially interact brought proximity sample preparation, even physically separated vivo. interactions may still reflect biological effects, taken account interpreting results.","code":""},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"PICtR: Physically Interacting Cell toolkit for R","text":"PICtR requires R version 4.3 later. First, please install BPCells. Next, PICtR can installed using: packages necessarily required, expand functionality PICtR. Consider installing: flowMeans dbscan Spectre ComplexHeatmap cytoMEM autothresholdr","code":"if (!require(\"remotes\", quietly = TRUE)) {   install.packages(\"remotes\") }  remotes::install_github(\"agSHaas/PICtR\")"},{"path":[]},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"pre-processing-of-cytometry-data","dir":"Articles","previous_headings":"PICtR Pipeline","what":"Pre-Processing of Cytometry Data","title":"PICtR: Physically Interacting Cell toolkit for R","text":"Data FCS files unmixed/compensated transformed (example using FlowJo BD). recommend using quality control tools PeacoQC FlowAI ensure high quality cytometry data. Export populations interest using channel values defined inbuilt export function FlowJo use flowWorkspace.","code":""},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"example-data","dir":"Articles","previous_headings":"PICtR Pipeline","what":"Example Data","title":"PICtR: Physically Interacting Cell toolkit for R","text":"provide small demo data set spleens lymphocytic choriomeningitis virus (LCMV) infected mice controls. Five days prior infection, LCMV-specific CD4 (CD90_1-positive) T cells transferred hosts. samples analysed using high parametric spectral flow cytometry n = 36 markers, allowing detection important cell types across immune cell landscape. demo data set, focus 10 different markers: CD3: T cell marker MHCII: Major histocompatibility complex II, expressed antigen-presenting cells CD11c: Dendritic cell (DC) marker CD11b: Myeloid cell marker CD45_2: Pan-hematopoetic marker, allelic form 2 CD19: B cell marker Ly6G: Neutrophil marker CD90_1: Marker LCMV-specific CD4 T cells CD4: Expressed CD4 T cells myeloid populations CD8: Expressed CD8 T cells, natural killer cells (NK) dendritic cells Details experimental setup can found Vonficht D, Jopp-Saile L, Yousefian S, Flore V et al. Ultra-high scale cytometry-based cellular interaction mapping. Nature Methods (2025). Demo data can loaded data(demo_lcmv). See ?demo_lcmv details.","code":""},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"subsampling-dimensional-reduction-and-clustering","dir":"Articles","previous_headings":"PICtR Pipeline","what":"Subsampling, Dimensional Reduction and Clustering","title":"PICtR: Physically Interacting Cell toolkit for R","text":"pipeline starts data frame dimensionality cells x flow cytometry parameters. First, calculate FSC ratio based forward scatter area (FSC-) forward scatter height (FSC-H) parameters. FSC ratio highly discriminatory singlets multiplets, help us select interacting populations clustering. find threshold classifies events low high FSC ratio using thresholding methods Otsu thresholding.  , create Seurat object using forward scatter parameters, side scatter parameters, cell type markers FSC ratio features. Several steps PICtR workflow make use Seurat framework. store counts layer -disk using BPCells, enabling us analyse millions events keeping computational time manageable. Thus far, analysed data sets 60 million events PICtR. addition, sample representative subset cells using atomic sketching implemented Seurat. contrast random sampling, sketching retains abundant rare cell types, including cellular interactions. demo data set, sample n_sketch_cells = 5000 cells. use sketched data set dimensional reduction clustering, predicting cell type interaction labels back full data set later . PICtR provides convenient wrapper function steps, including calculation FSC ratio threshold:","code":"library(PICtR) data(\"demo_lcmv\") threshold <- calculateThreshold((demo_lcmv$FSC.A/demo_lcmv$FSC.H), method = \"otsu\")  hist(demo_lcmv$FSC.A/demo_lcmv$FSC.H, breaks = 2000) abline(v = threshold) demo_obj <- sketch_wrapper(demo_lcmv,                        meta_data = demo_lcmv,                        assay = \"FACS\",                        FSC.A = \"FSC.A\",                         FSC.H = \"FSC.H\",                         working_dir = getwd(),                        resolution = c(0.5, 0.8, 1),                        clst_algorithm = 1,                        n_sketch_cells = 5000,                        obj_name = \"obj_sketched_non_projected\",                        ratio = T,                         thresholding_method = \"otsu\",                         overwrite = T) #> The BPCells directory will be overwritten #> Calculation of Ratio #> Warning: Matrix compression performs poorly with non-integers. #> • Consider calling convert_matrix_type if a compressed integer matrix is intended. #> Your newly generated object will be saved under: /Users/nflore/Documents/01_PICtR/PICtR/vignettes/obj_sketched_non_projected.rds #>  #> Sketching started... #>  #> Finding variable features for layer counts #>  #> Calcuating Leverage Score #>  #> Attempting to cast layer counts to dgCMatrix #>  #> Attempting to cast layer data to dgCMatrix #>  #> Sketching is done #>  #> Finding variable features for layer counts #>  #> Centering and scaling data matrix #>  #> PC_ 1  #> Positive:  CD4, Ly6G, CD11b, CD90-1, CD8, CD11c, SSC.H, MHCII  #> Negative:  FSC.A, ratio, SSC.A, FSC.H, CD45-2, CD3, CD19  #> PC_ 2  #> Positive:  CD4, CD45-2, CD3, CD90-1, CD8, MHCII, CD19, ratio  #> Negative:  CD11b, SSC.H, Ly6G, SSC.A, FSC.H, CD11c, FSC.A  #> PC_ 3  #> Positive:  CD4, CD90-1, CD3, SSC.H, CD11b, SSC.A, FSC.H, CD8  #> Negative:  MHCII, CD19, ratio, CD45-2, FSC.A, CD11c, Ly6G  #> PC_ 4  #> Positive:  CD19, CD90-1, CD4, Ly6G, ratio, FSC.A, SSC.A, MHCII  #> Negative:  CD11c, CD8, CD45-2, CD11b, CD3, SSC.H, FSC.H  #> PC_ 5  #> Positive:  CD11c, MHCII, CD4, CD90-1, CD45-2, SSC.H, CD11b, SSC.A  #> Negative:  CD8, Ly6G, CD19, CD3, FSC.H, FSC.A, ratio  #>  #> Computing nearest neighbor graph #>  #> Computing SNN #>  #> This message is displayed once every 8 hours. #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 5000 #> Number of edges: 164643 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.9193 #> Number of communities: 14 #> Elapsed time: 0 seconds #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 5000 #> Number of edges: 164643 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8959 #> Number of communities: 16 #> Elapsed time: 0 seconds #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 5000 #> Number of edges: 164643 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8813 #> Number of communities: 19 #> Elapsed time: 0 seconds #> UMAP will return its model #> 20:11:48 UMAP embedding parameters a = 0.9922 b = 1.112 #> 20:11:48 Read 5000 rows and found 15 numeric columns #> 20:11:48 Using Annoy for neighbor search, n_neighbors = 30 #> 20:11:48 Building Annoy index with metric = cosine, n_trees = 50 #> 0%   10   20   30   40   50   60   70   80   90   100% #> [----|----|----|----|----|----|----|----|----|----| #> **************************************************| #> 20:11:49 Writing NN index file to temp file /var/folders/zq/k957_k5s79v97_ptgc729fm1yy94mx/T//RtmpYHxJB7/file90991964f904 #> 20:11:49 Searching Annoy index using 1 thread, search_k = 3000 #> 20:11:49 Annoy recall = 100% #> 20:11:50 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 30 #> 20:11:50 Initializing from normalized Laplacian + noise (using RSpectra) #> 20:11:50 Commencing optimization for 500 epochs, with 202814 positive edges #> 20:11:50 Using rng type: pcg #> 20:11:54 Optimization finished #> The object will be updated and saved"},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"guidelines-for-clustering","dir":"Articles","previous_headings":"PICtR Pipeline > Subsampling, Dimensional Reduction and Clustering","what":"Guidelines for Clustering","title":"PICtR: Physically Interacting Cell toolkit for R","text":"Finding good clustering resolution critical detecting annotating interacting populations. PICtR provides several different options clustering: addition Louvain, SLM, Leiden algorithms, implemented Seurat framework, FlowSOM, flowMeans HDBSCAN (Hierarchical Density-Based Spatial Clustering Applications Noise) available. recommend using Louvain Leiden due successful identification interacting populations, fast run times, easy customization resolution parameter (note Leiden requires leidenalg python package). effect resolution parameter can seen comparing resolution 0.5, 0.8 1 (Louvain clustering) demo data set:  recommend -cluster data ensure detection small populations, including cellular interactions. expect roughly 20 different cell types based flow cytometry panel, aim cluster resolution provides 20 clusters. Subsequently, annotation, clusters representing cell type can merged. Alternatively, clusters represent populations interest require higher resolutions, sub-clustering can performed (FindSubCluster()). Different resolutions might tested deciding best fit. can also helpful compare cluster boundaries feature plots markers used annotation see capture relevant patterns. demo data set, resolution 0.5 seems sufficient:  Seurat tutorials Heumos et al. (2023) provide excellent guidance clustering single-cell data sets.","code":"DimPlot(demo_obj, group.by = \"sketch_snn_res.0.5\", label = T) + theme(legend.position = \"none\") DimPlot(demo_obj, group.by = \"sketch_snn_res.0.8\", label = T) + theme(legend.position = \"none\") DimPlot(demo_obj, group.by = \"sketch_snn_res.1\", label = T) + theme(legend.position = \"none\") FeaturePlot(demo_obj, features = c(\"CD3\", \"MHCII\", \"CD11c\", \"CD11b\",                                     \"CD45_2\", \"CD19\", \"Ly6G\",                                     \"CD90_1\", \"CD4\", \"CD8\", \"ratio\"))"},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"predict-labels-for-the-full-data-set","dir":"Articles","previous_headings":"PICtR Pipeline","what":"Predict Labels for the full Data Set","title":"PICtR: Physically Interacting Cell toolkit for R","text":"Currently, cluster labels exist sketched subset cells, can predict labels entire data set using linear discriminant analysis (LDA) implemented predict_data() function:","code":"demo_obj <- predict_data(obj = demo_obj,                        data_query = demo_obj,                        ref_clusters = \"sketch_snn_res.0.5\",                       pred_name = \"clusters_predicted\",                       assay_ref = \"sketch\",                        assay_query = \"FACS\") #> Warning: Converting to a dense matrix may use excessive memory #> This message is displayed once every 8 hours."},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"selecting-interacting-populations","dir":"Articles","previous_headings":"PICtR Pipeline","what":"Selecting Interacting Populations","title":"PICtR: Physically Interacting Cell toolkit for R","text":"Now can select clusters represent interacting cells. cluster, determine proportion cells FSC ratio threshold calculated earlier:  seen bar plot, clusters 3, 7, 10, 11, 13 predominantly contain cells exceed FSC ratio threshold. select_dbt() function can used pick clusters. recommend investigating ratio_cluster_plot() confirm selection make.","code":"ratio_cluster_plot(demo_obj, clusters = \"clusters_predicted\")"},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"singlet-annotation","dir":"Articles","previous_headings":"PICtR Pipeline","what":"Singlet Annotation","title":"PICtR: Physically Interacting Cell toolkit for R","text":"Based previous analysis, clusters 3, 7, 10, 11 13 identified representing interacting cells. Now, can annotate remaining clusters help feature plots (see ) ridge plots:  Based marker expression, can annotate clusters follows:","code":"Idents(demo_obj) <- \"clusters_predicted\" RidgePlot(demo_obj, features = Features(demo_obj)) & theme(axis.text = element_text(size = 7)) #> Picking joint bandwidth of 23.7 #> Picking joint bandwidth of 20.3 #> Picking joint bandwidth of 9.11 #> Picking joint bandwidth of 15.5 #> Picking joint bandwidth of 24.9 #> Picking joint bandwidth of 21.7 #> Picking joint bandwidth of 26.5 #> Picking joint bandwidth of 32.7 #> Picking joint bandwidth of 28.4 #> Picking joint bandwidth of 43 #> Picking joint bandwidth of 28.9 #> Picking joint bandwidth of 11.3 #> Picking joint bandwidth of 19.9 #> Picking joint bandwidth of 9.44 #> Picking joint bandwidth of 19.1 demo_obj@meta.data <- demo_obj@meta.data %>%    mutate(celltype = case_when(clusters_predicted == \"0\" ~ \"B cells\",                                clusters_predicted == \"1\" ~ \"CD8 T cells\",                                clusters_predicted == \"2\" ~ \"DCs\",                                clusters_predicted == \"3\" ~ \"interacting cells\",                                clusters_predicted == \"4\" ~ \"LCMV-spec CD4 T cells\",                                clusters_predicted == \"5\" ~ \"Myeloid cells\",                                clusters_predicted == \"6\" ~ \"CD4 T cells\",                                clusters_predicted == \"7\" ~ \"interacting cells\",                                clusters_predicted == \"8\" ~ \"Myeloid cells\",                                clusters_predicted == \"9\" ~ \"Neutrophils\",                               clusters_predicted == \"10\" ~ \"interacting cells\",                                clusters_predicted == \"11\" ~ \"interacting cells\",                                clusters_predicted == \"12\" ~ \"DCs\",                                clusters_predicted == \"13\" ~ \"interacting cells\"))  DimPlot(demo_obj, group.by = \"celltype\", label =T)"},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"annotation-of-interacting-populations","dir":"Articles","previous_headings":"PICtR Pipeline","what":"Annotation of Interacting Populations","title":"PICtR: Physically Interacting Cell toolkit for R","text":"Annotating interacting cells easier subset re-cluster :   can move forward resolution 0.5, pattern CD8 within cluster 4 well represented clustering resolution. can sub-cluster population shared-nearest-neighbor graph (FACS_snn) using FindSubCluster() low resolution:  Now can annotate interacting cells based mutually exclusive marker expression. CD19 example expressed B cells, CD3 CD4 expression found CD4+ T cells. CD19, CD3 CD4 simultaneously expressed within interacting cluster, know interaction partners B cells CD4+ T cells. label interactions asterisk (*):  Cluster 10 lower CD45_2 expression low ratio, remove interacting landscape. Clusters 0 1 exhibit mutually exclusive marker expression - populations express B cell markers. likely represent homotypic B cell interactions, rule alternative explanations preceding cytokinesis interactions cells marker . exclude populations recalculate UMAP embedding:","code":"# subset interacting cells DefaultAssay(demo_obj) <- \"FACS\" Idents(demo_obj) <- \"celltype\" interact_obj <- subset(demo_obj, idents = \"interacting cells\")  # repeat the Seurat workflow  n_dims <- length(Features(demo_obj)) interact_obj <- interact_obj %>%   FindVariableFeatures() %>%   ScaleData() %>%   RunPCA(npcs=n_dims, approx=F) %>%   FindNeighbors(dims = 1:n_dims) %>%    FindClusters(resolution = c(0.5, 0.8, 1)) %>%    RunUMAP(dims = 1:n_dims, return.model = T) #> Finding variable features for layer counts #> PC_ 1  #> Positive:  MHCII, CD19, CD45-2, CD4, Ly6G, CD8, CD90-1, CD11b  #> Negative:  SSC.A, FSC.A, SSC.H, FSC.H, CD3, CD11c, ratio  #> PC_ 2  #> Positive:  CD4, CD3, CD8, CD11c, CD90-1, CD11b, FSC.H, CD45-2  #> Negative:  CD19, MHCII, SSC.A, ratio, FSC.A, SSC.H, Ly6G  #> PC_ 3  #> Positive:  CD45-2, CD4, CD3, ratio, CD19, FSC.A, CD90-1, MHCII  #> Negative:  Ly6G, CD11b, SSC.H, SSC.A, CD11c, FSC.H, CD8  #> PC_ 4  #> Positive:  CD90-1, FSC.H, SSC.H, CD4, FSC.A, SSC.A, CD19, MHCII  #> Negative:  CD45-2, CD11b, CD11c, CD8, CD3, ratio, Ly6G  #> PC_ 5  #> Positive:  CD8, FSC.A, CD11c, FSC.H, ratio, SSC.A, CD19, MHCII  #> Negative:  CD4, CD45-2, Ly6G, CD90-1, CD11b, CD3, SSC.H #> Computing nearest neighbor graph #> Computing SNN #> UMAP will return its model #> 20:12:08 UMAP embedding parameters a = 0.9922 b = 1.112 #> 20:12:08 Read 9808 rows and found 15 numeric columns #> 20:12:08 Using Annoy for neighbor search, n_neighbors = 30 #> 20:12:08 Building Annoy index with metric = cosine, n_trees = 50 #> 0%   10   20   30   40   50   60   70   80   90   100% #> [----|----|----|----|----|----|----|----|----|----| #> **************************************************| #> 20:12:08 Writing NN index file to temp file /var/folders/zq/k957_k5s79v97_ptgc729fm1yy94mx/T//RtmpYHxJB7/file9099731098f6 #> 20:12:08 Searching Annoy index using 1 thread, search_k = 3000 #> 20:12:10 Annoy recall = 100% #> 20:12:10 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 30 #> 20:12:10 Initializing from normalized Laplacian + noise (using RSpectra) #> 20:12:11 Commencing optimization for 500 epochs, with 406056 positive edges #> 20:12:11 Using rng type: pcg #> 20:12:18 Optimization finished  # plot the different clustering resolutions DimPlot(interact_obj, group.by = \"FACS_snn_res.0.5\", label = T) + theme(legend.position = \"none\") DimPlot(interact_obj, group.by = \"FACS_snn_res.0.8\", label = T) + theme(legend.position = \"none\") DimPlot(interact_obj, group.by = \"FACS_snn_res.1\", label = T) + theme(legend.position = \"none\") #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 9808 #> Number of edges: 329874 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8902 #> Number of communities: 11 #> Elapsed time: 0 seconds #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 9808 #> Number of edges: 329874 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8573 #> Number of communities: 15 #> Elapsed time: 0 seconds #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 9808 #> Number of edges: 329874 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8421 #> Number of communities: 20 #> Elapsed time: 0 seconds FeaturePlot(interact_obj, features = c(\"CD3\", \"MHCII\", \"CD11c\", \"CD11b\",                                     \"CD45_2\", \"CD19\", \"Ly6G\",                                     \"CD90_1\", \"CD4\", \"CD8\", \"ratio\")) Idents(interact_obj) <- \"FACS_snn_res.0.5\" interact_obj <- FindSubCluster(interact_obj, cluster = \"4\",                                 graph.name = \"FACS_snn\", resolution = 0.25)  # plot  DimPlot(interact_obj, group.by = \"sub.cluster\", label = T) #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 845 #> Number of edges: 29301 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8506 #> Number of communities: 3 #> Elapsed time: 0 seconds Idents(interact_obj) <- \"sub.cluster\" RidgePlot(interact_obj, features = Features(interact_obj)) &    theme(axis.text = element_text(size = 7)) #> Picking joint bandwidth of 18.7 #> Picking joint bandwidth of 19.4 #> Picking joint bandwidth of 7.69 #> Picking joint bandwidth of 16.2 #> Picking joint bandwidth of 21.4 #> Picking joint bandwidth of 15.8 #> Picking joint bandwidth of 24 #> Picking joint bandwidth of 30.3 #> Picking joint bandwidth of 23.8 #> Picking joint bandwidth of 47.8 #> Picking joint bandwidth of 28 #> Picking joint bandwidth of 9.23 #> Picking joint bandwidth of 14.4 #> Picking joint bandwidth of 6.68 #> Picking joint bandwidth of 21.2 interact_obj@meta.data <- interact_obj@meta.data %>%    mutate(interact_type = case_when(sub.cluster == \"0\" ~ \"B cells only\",                                sub.cluster == \"1\" ~ \"B cells only\",                                sub.cluster == \"2\" ~ \"B*DC\",                                sub.cluster == \"3\" ~ \"B*CD4 T\",                                sub.cluster == \"4_0\" ~ \"DC*LCMV-spec CD4 T\",                                sub.cluster == \"4_1\" ~ \"B*LCMV-spec CD4 T\",                                sub.cluster == \"4_2\" ~ \"B*DC*LCMV-spec CD4 T\",                                sub.cluster == \"5\" ~ \"CD4 T*DC\",                                sub.cluster == \"6\" ~ \"B*CD8 T\",                                sub.cluster == \"7\" ~ \"B*Neutrophils\",                                sub.cluster == \"8\" ~ \"CD4*CD8\",                                sub.cluster == \"9\" ~ \"B*Myeloid\",                               sub.cluster == \"10\" ~ \"remove\")) keep <- interact_obj@meta.data %>%    dplyr::filter(interact_type %in% c(\"B*Neutrophils\",                                       \"CD4*CD8\",                                       \"B*CD4 T\",                                                   \"B*Myeloid\",                                      \"B*DC\",                                      \"DC*LCMV-spec CD4 T\",                                      \"B*LCMV-spec CD4 T\",                                      \"B*DC*LCMV-spec CD4 T\",                                      \"B*CD8 T\",                                      \"CD4 T*DC\")) interact_obj <- subset(interact_obj, cells = rownames(keep))  interact_obj <- interact_obj %>%    RunUMAP(dims = 1:n_dims, return.model = T) #> UMAP will return its model #> 20:12:24 UMAP embedding parameters a = 0.9922 b = 1.112 #> 20:12:24 Read 5482 rows and found 15 numeric columns #> 20:12:24 Using Annoy for neighbor search, n_neighbors = 30 #> 20:12:24 Building Annoy index with metric = cosine, n_trees = 50 #> 0%   10   20   30   40   50   60   70   80   90   100% #> [----|----|----|----|----|----|----|----|----|----| #> **************************************************| #> 20:12:24 Writing NN index file to temp file /var/folders/zq/k957_k5s79v97_ptgc729fm1yy94mx/T//RtmpYHxJB7/file90992b43db9e #> 20:12:24 Searching Annoy index using 1 thread, search_k = 3000 #> 20:12:25 Annoy recall = 100% #> 20:12:25 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 30 #> 20:12:26 Initializing from normalized Laplacian + noise (using RSpectra) #> 20:12:26 Commencing optimization for 500 epochs, with 222518 positive edges #> 20:12:26 Using rng type: pcg #> 20:12:30 Optimization finished  # plot  DimPlot(interact_obj, group.by = \"interact_type\", label = T)"},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"downstream-analysis","dir":"Articles","previous_headings":"PICtR Pipeline","what":"Downstream Analysis","title":"PICtR: Physically Interacting Cell toolkit for R","text":"annotating singlet interacting landscapes, can continue downstream analyses according experimental setup. Often, involve quantification interactions case control conditions test significant differences.","code":""},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"citing-pictr","dir":"Articles","previous_headings":"","what":"Citing PICtR","title":"PICtR: Physically Interacting Cell toolkit for R","text":"using PICtR research, please consider citing: Vonficht, Jopp-Saile, Yousefian, Flore et al. Ultra-high-scale cytometry-based cellular interaction mapping. Nature Methods (2025). https://doi.org/10.1038/s41592-025-02744-w","code":""},{"path":"https://agshaas.github.io/PICtR/articles/PICtR.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"PICtR: Physically Interacting Cell toolkit for R","text":"Vonficht, Jopp-Saile, Yousefian, Flore et al. Ultra-high-scale cytometry-based cellular interaction mapping. Nature Methods (2025). https://doi.org/10.1038/s41592-025-02744-w Hao Y et al. Dictionary learning integrative, multimodal scalable single-cell analysis. Nat Biotechnol 42, 293–304 (2024). https://doi.org/10.1038/s41587-023-01767-y Heumos L, Schaar .C. et al. Best practices single-cell analysis across modalities. Nat Rev Genet (2023). https://doi.org/10.1038/s41576-023-00586-w Parks B & Abdi . BPCells: Single Cell Counts Matrices PCA. R package version 0.2.0 (2024) https://bnprks.github.io/BPCells","code":""},{"path":"https://agshaas.github.io/PICtR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lea Jopp-Saile. Author. Viktoria Flore. Author, maintainer.","code":""},{"path":"https://agshaas.github.io/PICtR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Vonficht, Jopp-Saile, Yousefian, Flore et al. Ultra-high scale cytometry-based cellular interaction mapping. Nature Methods (2025)","code":"@Article{,   author = {Dominik Vonficht and Lea Jopp-Saile and Schayan Yousefian and Viktoria Flore and Ines Simo Vesperinas and Ruth Teuber and Bogdan Avanesyan and Yanjiang Luo and Caroline Roethemeier and Florian Gruenschlaeger and Mirian Fernandez-Vaquero and Vincent Fregona and Diana Ordonez-Rueda and Laura K. Schmalbrock and Luca Deininger and Angelo Jovin Yamachui Sitcheu and Zuguang Gu and Maja C. Funk and Ralf Mikut and Mathias Heikenwaelder and Angelika Eggert and Arend {von Stackelberg} and Sebastian Kobold and Jan Kroenke and Ulrich Keller and Andreas Trumpp and Ahmed N. Hegazy and Cornelia Eckert and Daniel Huebschmann and Simon Haas},   title = {Ultra-high scale cytometry-based cellular interaction mapping},   year = {2025},   journal = {Nature Methods}, }"},{"path":"https://agshaas.github.io/PICtR/index.html","id":"pictr","dir":"","previous_headings":"","what":"Physically Interacting Cell (PIC) toolkit for R","title":"Physically Interacting Cell (PIC) toolkit for R","text":"computational workflow analyse physically interacting cells (PICs) flow cytometry data using R.","code":""},{"path":"https://agshaas.github.io/PICtR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Physically Interacting Cell (PIC) toolkit for R","text":"PICtR requires R version 4.3 later. First, please install BPCells. Next, PICtR can installed using:","code":"if (!require(\"remotes\", quietly = TRUE)) {   install.packages(\"remotes\") }  remotes::install_github(\"agSHaas/PICtR\")"},{"path":"https://agshaas.github.io/PICtR/index.html","id":"workflow","dir":"","previous_headings":"","what":"Workflow","title":"Physically Interacting Cell (PIC) toolkit for R","text":"Please refer Vignette Method section manuscript comprehensive description analysis pipeline.","code":""},{"path":"https://agshaas.github.io/PICtR/index.html","id":"demo-data","dir":"","previous_headings":"","what":"Demo Data","title":"Physically Interacting Cell (PIC) toolkit for R","text":"package comprises demo data set LCMV infected mice. Data analysed using high parametric spectral flow cytometry can loaded data(demo_lcmv). See ?demo_lcmv details.","code":""},{"path":"https://agshaas.github.io/PICtR/index.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"Physically Interacting Cell (PIC) toolkit for R","text":"core framework relies Seurat version 5, BPCells, MASS, tidyverse. Please make sure R operating version 4.3 higher. packages necessarily required, expand functionality PICtR. Consider installing: flowMeans dbscan Spectre ComplexHeatmap cytoMEM autothresholdr","code":""},{"path":"https://agshaas.github.io/PICtR/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Physically Interacting Cell (PIC) toolkit for R","text":"use PICtR work, please cite Vonficht, Jopp-Saile, Yousefian, Flore et al. Ultra-high-scale cytometry-based cellular interaction mapping. Nature Methods (2025). https://doi.org/10.1038/s41592-025-02744-w","code":""},{"path":"https://agshaas.github.io/PICtR/index.html","id":"version","dir":"","previous_headings":"","what":"Version","title":"Physically Interacting Cell (PIC) toolkit for R","text":"Current version 1.0.1","code":""},{"path":"https://agshaas.github.io/PICtR/reference/MEM_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Marker Enrichment Modeling (MEM) Heatmap. — MEM_heatmap","title":"Marker Enrichment Modeling (MEM) Heatmap. — MEM_heatmap","text":"Marker Enrichment Modeling (MEM) Heatmap.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/MEM_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Marker Enrichment Modeling (MEM) Heatmap. — MEM_heatmap","text":"","code":"MEM_heatmap(   obj,   markers = c(),   cluster_col = \"seurat_clusters\",   cols = pals::coolwarm(100),   heatmap_name = \"MEM enrichment score\",   heatmap_column_title = \"marker\",   heatmap_row_title = \"cluster\",   scale_width = 2.2,   scale_height = 5 )"},{"path":"https://agshaas.github.io/PICtR/reference/MEM_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Marker Enrichment Modeling (MEM) Heatmap. — MEM_heatmap","text":"obj Seurat object. markers Meta.data columns features plotted heatmap clustering resolution. cluster_col Character string specifying column contains clustering solution. cols Color palette. heatmap_name Title heatmap. heatmap_column_title Title columns heatmap. heatmap_row_title Title rows heatmap. scale_width Scaling factor width heatmap relation number columns. scale_height Scaling factor height heatmap relation number rows.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/MEM_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Marker Enrichment Modeling (MEM) Heatmap. — MEM_heatmap","text":"MEM heat map.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/PICtR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"PICtR: Physically Interacting Cell (PIC) toolkit for R — PICtR-package","title":"PICtR: Physically Interacting Cell (PIC) toolkit for R — PICtR-package","text":"computational workflow analyse physically interacting cells (PICs) flow cytometry data using R.","code":""},{"path":[]},{"path":"https://agshaas.github.io/PICtR/reference/PICtR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"PICtR: Physically Interacting Cell (PIC) toolkit for R — PICtR-package","text":"Maintainer: Viktoria Flore viktoria.flore@bih-charite.de (ORCID) Authors: Lea Jopp-Saile jopp-saile@protonmail.com (ORCID)","code":""},{"path":"https://agshaas.github.io/PICtR/reference/calculateThreshold.html","id":null,"dir":"Reference","previous_headings":"","what":"Threshold calculation — calculateThreshold","title":"Threshold calculation — calculateThreshold","text":"Calculates threshold based different methods.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/calculateThreshold.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Threshold calculation — calculateThreshold","text":"","code":"calculateThreshold(data, method = \"otsu\", breaks = 2000, seed = 42)"},{"path":"https://agshaas.github.io/PICtR/reference/calculateThreshold.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Threshold calculation — calculateThreshold","text":"data data calculate threshold . Must non-negative integers autothresholdr methods, see . method method used thresholding. One : \"otsu\", \"triangle\", \"kmeans\" methods autothresholdr package, see auto_thresh (\"IJDefault\", \"Huang\", \"Huang2\", \"Intermodes\", \"IsoData\", \"Li\", \"MaxEntropy\", \"Mean\", \"MinErrorI\", \"Minimum\", \"Moments\", \"Otsu\", \"Percentile\", \"RenyiEntropy\", \"Shanbhag\", \"Triangle\" \"Yen\"). autothresholdr methods, data forced integers (Default: \"otsu\"). breaks Number histogram breaks methods rely histograms. >100 (Default: 2000). seed Seed reproducibility (Default: 42).","code":""},{"path":"https://agshaas.github.io/PICtR/reference/calculateThreshold.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Threshold calculation — calculateThreshold","text":"Numerical threshold value","code":""},{"path":"https://agshaas.github.io/PICtR/reference/calculateThreshold.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Threshold calculation — calculateThreshold","text":"N. Otsu, \"Threshold Selection Method Gray-Level Histograms,\" IEEE Transactions Systems, Man, Cybernetics, vol. 9, . 1, pp. 62-66, Jan. 1979, doi: 10.1109/TSMC.1979.4310076. Zack GW, Rogers , Latt SA. Automatic measurement sister chromatid exchange frequency. Journal Histochemistry & Cytochemistry. 1977;25(7):741-753. doi: 10.1177/25.7.70454. Hartigan, J. ., & Wong, M. . (1979). Algorithm 136: K-Means Clustering Algorithm. Journal Royal Statistical Society. Series C (Applied Statistics), 28(1), 100–108. https://doi.org/10.2307/2346830. G. Landini, D.. Randell, S. Fouad, . Galton. Automatic thresholding gradients region boundaries. Journal Microscopy, 265(2), 185-195.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/calculateThreshold.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Threshold calculation — calculateThreshold","text":"","code":"data(\"demo_lcmv\") demo_lcmv$ratio <- demo_lcmv$FSC.A/demo_lcmv$FSC.H threshold <- calculateThreshold(demo_lcmv$ratio, method = \"otsu\", breaks = 2000)"},{"path":"https://agshaas.github.io/PICtR/reference/demo_lcmv.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo data set — demo_lcmv","title":"Demo data set — demo_lcmv","text":"Demo data set PICtR workflow containing sampled cells spleens LCMV infected mice (day 7) control. demonstration purposes, CD3, MHCII, CD11c, CD11b, CD45_2, CD19, Ly6G, CD90_1, CD4, CD8 included cell type markers.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/demo_lcmv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo data set — demo_lcmv","text":"","code":"data(demo_lcmv)"},{"path":"https://agshaas.github.io/PICtR/reference/demo_lcmv.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo data set — demo_lcmv","text":"72620 observations (cells) 14 variables (markers, scaled 0-1023). FSC.Forward scatter area FSC.H Forward scatter height SSC.Side scatter area SSC.H Side scatter height fluorescence markers CD3, MHCII, CD11c, CD11b, CD45_2, CD19, Ly6G, CD90_1, CD4, CD8","code":""},{"path":"https://agshaas.github.io/PICtR/reference/demo_lcmv.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Demo data set — demo_lcmv","text":"Vonficht, Jopp-Saile, Yousefian, Flore et al. Ultra-high scale cytometry-based cellular interaction mapping. Nature Methods (2025)","code":""},{"path":"https://agshaas.github.io/PICtR/reference/predict_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster label prediction — predict_data","title":"Cluster label prediction — predict_data","text":"Predicts cluster labels reference data set query data set using lda.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/predict_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster label prediction — predict_data","text":"","code":"predict_data(   obj = obj,   data_query = query,   ref_clusters = NULL,   FSC.A = \"FSC.A\",   FSC.H = \"FSC.H\",   pred_name = \"clusters_predicted\",   assay_ref = NULL,   assay_query = NULL,   chunk_size = 1e+06,   return_obj = TRUE )"},{"path":"https://agshaas.github.io/PICtR/reference/predict_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster label prediction — predict_data","text":"obj Seurat object. data_query data frame Seurat object cells whose labels predicted. ref_clusters meta.data column reference cluster labels. FSC.name column containing FSC.scatter parameter. FSC.H name column containing FSC.H scatter parameter. pred_name name meta.data column predicted cluster labels (character vector). assay_ref name Seurat assay used calculate reference cluster labels. assay_query name Seurat assay containing cells whose labels predicted. query provided Seurat object. chunk_size Chunk size prediction progress verbose output standard . return_obj Boolean. Add predicted cluster labels Seurat object? query provided data frame.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/predict_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster label prediction — predict_data","text":"Seurat object data frame containing predicted cluster labels.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/predict_data.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cluster label prediction — predict_data","text":"Venables, W. N. & Ripley, B. D. (2002) Modern Applied Statistics S. Fourth Edition. Springer, New York. ISBN 0-387-95457-0 Ripley, B. D. (1996) Pattern Recognition Neural Networks. Cambridge University Press.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/ratio_cluster_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Ratio cluster plot. — ratio_cluster_plot","title":"Ratio cluster plot. — ratio_cluster_plot","text":"Stacked bar plot cluster proportion cells /determined FSC./FSC.H ratio threshold.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/ratio_cluster_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ratio cluster plot. — ratio_cluster_plot","text":"","code":"ratio_cluster_plot(   obj,   clusters = \"seurat_clusters\",   ratio = \"ratio_anno\",   assay = \"FACS\" )"},{"path":"https://agshaas.github.io/PICtR/reference/ratio_cluster_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ratio cluster plot. — ratio_cluster_plot","text":"obj Seurat object. clusters string meta.data column clustering resolution plot. ratio meta.data column classification cells (ratio_high/ratio_low) determined using FSC./FSC.H ratio determined threshold. assay Seurat assay use (default FACS).","code":""},{"path":"https://agshaas.github.io/PICtR/reference/ratio_cluster_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ratio cluster plot. — ratio_cluster_plot","text":"None","code":""},{"path":"https://agshaas.github.io/PICtR/reference/save.obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Save Seurat object — save.obj","title":"Save Seurat object — save.obj","text":"Wrapper function saving Seurat objects","code":""},{"path":"https://agshaas.github.io/PICtR/reference/save.obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save Seurat object — save.obj","text":"","code":"save.obj(object, path = output_obj_path, file)"},{"path":"https://agshaas.github.io/PICtR/reference/save.obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save Seurat object — save.obj","text":"object Seurat Object. path Directory path. file File name.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/save.obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save Seurat object — save.obj","text":"None","code":""},{"path":"https://agshaas.github.io/PICtR/reference/save.plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Save plot — save.plot","title":"Save plot — save.plot","text":"Wrapper function saving plots pdf file.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/save.plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save plot — save.plot","text":"","code":"save.plot(plot, path = output_plot_path, file, dim_h = 7, dim_w = 5)"},{"path":"https://agshaas.github.io/PICtR/reference/save.plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save plot — save.plot","text":"plot plot. path Directory path. file file name. dim_h Height parameter pdf dim_w Width parameter pdf","code":""},{"path":"https://agshaas.github.io/PICtR/reference/save.plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save plot — save.plot","text":"None","code":""},{"path":"https://agshaas.github.io/PICtR/reference/select_dbt.html","id":null,"dir":"Reference","previous_headings":"","what":"Selection of clusters containing physically interacting cells. — select_dbt","title":"Selection of clusters containing physically interacting cells. — select_dbt","text":"Selects clusters belong given percentile clusters largest physically interacting cells proportion based FSC ratio thresholding. default, top 20 percent clusters chosen. Consider using ratio_cluster_plot evaluate choice percentile cutoff.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/select_dbt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Selection of clusters containing physically interacting cells. — select_dbt","text":"","code":"select_dbt(   obj,   clusters = \"seurat_clusters\",   ratio = \"ratio_anno\",   ratio_high = \"Ratio_high\",   assay = \"FACS\",   quantile = 0.8,   selected_clusters = \"doublet_clusters\" )"},{"path":"https://agshaas.github.io/PICtR/reference/select_dbt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Selection of clusters containing physically interacting cells. — select_dbt","text":"obj Seurat object. clusters meta.data column containing cluster labels (Default: seurat_clusters). ratio meta.data column classification cells ratio_high ratio_low using FSC ratio (FSC./FSC.H) thresholding method. ratio_high character string indicates cells FSC ratio (FSC./FSC.H) threshold determined calculateThreshold within meta.data column. assay Seurat assay containing FACS data. quantile desired percentile cutoff clusters classified physically interacting cell clusters (Default 0.8, meaning top 20 percent clusters chosen). selected_clusters Character vector misc slot Seurat object contain cluster numbers selected physically interacting cell clusters (Default: \"doublet_clusters\").","code":""},{"path":"https://agshaas.github.io/PICtR/reference/select_dbt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Selection of clusters containing physically interacting cells. — select_dbt","text":"Seurat object","code":""},{"path":"https://agshaas.github.io/PICtR/reference/sketch_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"PICtR workflow wrapper — sketch_wrapper","title":"PICtR workflow wrapper — sketch_wrapper","text":"Characterizes cells ratio_high ratio_low cells physically interacting cell analysis, samples representative subset cells using SketchData runs standard Seurat analysis workflow.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/sketch_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PICtR workflow wrapper — sketch_wrapper","text":"","code":"sketch_wrapper(   channel = channel,   meta_data = NULL,   assay = \"FACS\",   FSC.A = \"FSC.A\",   FSC.H = \"FSC.H\",   n_sketch_cells = 50000,   n_components = \"all\",   clst_algorithm = 1,   resolution = c(0.5, 1, 2, 3, 4),   min_clst_size = 100,   meta.k = \"auto\",   obj_name = \"obj_sketched_non_projected\",   ratio = TRUE,   thresholding_method = \"otsu\",   hist_breaks = 2000,   group_by = NULL,   verbose = TRUE,   BPcell_dir = NULL,   overwrite = F,   working_dir = getwd(),   seed = 42 )"},{"path":"https://agshaas.github.io/PICtR/reference/sketch_wrapper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PICtR workflow wrapper — sketch_wrapper","text":"channel data frame dimensionality cells x flow cytometry parameters. meta_data data frame meta_data every cell (Default=NULL). assay character string name assay created (Default=\"FACS\"). FSC.name (string) column containing FSC.scatter parameter (Default=\"FACS.\"). FSC.H name (string) column containing FSC.H scatter parameter (Default=\"FACS.H\"). n_sketch_cells number cells subsampled SketchData (Default=50000). n_components number components computed used analysis. \"\" given integer (Default=\"\"). clst_algorithm Algorithm used clustering. Seurat's FindClusters: 1 = original Louvain algorithm; 2 = Louvain algorithm multilevel refinement; 3 = SLM algorithm; 4 = Leiden algorithm). Leiden requires leidenalg python. Alternatively, \"hdbscan\" Hierarchical Density-Based Spatial Clustering Applications Noise (HDBSCAN) UMAP embedding, see hdbscan), \"flowMeans\" non-parametric clustering segmented-regression-based change point detection, see flowMeans, \"flowSOM\" self-organizing maps, see run.flowsom, (Default: Louvain, 1) resolution numerical vector desired resolutions clustering (Default: c(0.5,1,2,3,4)). used Louvain, SLM, Leiden clustering. min_clst_size minimum cluster size HDBSCAN. See details hdbscan (Default: 100). meta.k meta k FlowSOM clustering, see run.flowsom (Default: \"auto\"). obj_name name used storing Seurat object (character). ratio Boolean variable. TRUE FSC ratio (FSC./FSC.H) calculated. thresholding_method Method thresholding. One \"otsu\", \"triangle\", \"kmeans\", method autothresholdr package. details see ?calculateThreshold() (Default = \"otsu\"). hist_breaks Number histogram breaks methods rely histograms. >100 (Default: 2000). group_by Optional grouping parameter calculate FSC ratio (FSC./FSC.H) thresholding method . verbose Verbosity (Boolean). BPcell_dir Optional directory counts matrix open_matrix_dir. overwrite Overwrite existing BPCells directory? (Default: FALSE) working_dir Directory path used working directory (character string). seed Seed reproducibility (Default: 42).","code":""},{"path":"https://agshaas.github.io/PICtR/reference/sketch_wrapper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PICtR workflow wrapper — sketch_wrapper","text":"Seurat object.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/sketch_wrapper.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"PICtR workflow wrapper — sketch_wrapper","text":"Hao et al. Dictionary learning integrative, multimodal scalable single-cell analysis. Nature Biotechnology (2023). doi: https://doi.org/10.1038/s41587-023-01767-y. Van Gassen S et al. (2015) FlowSOM: Using self-organizing maps visualization interpretation cytometry data. Cytom Part J Int Soc Anal Cytol 87: 636-645. https://onlinelibrary.wiley.com/doi/full/10.1002/cyto..22625. Aghaeepour, N., Nikolic, R., Hoos, H.H. Brinkman, R.R. (2011), Rapid cell population identification flow cytometry data. Cytometry, 79A: 6-13. https://doi.org/10.1002/cyto..21007. Campello, R.J.G.B., Moulavi, D., Sander, J. (2013). Density-Based Clustering Based Hierarchical Density Estimates. : Pei, J., Tseng, V.S., Cao, L., Motoda, H., Xu, G. (eds) Advances Knowledge Discovery Data Mining. PAKDD 2013. Lecture Notes Computer Science(), vol 7819. Springer, Berlin, Heidelberg. https://doi.org/10.1007/978-3-642-37456-2_14","code":""},{"path":"https://agshaas.github.io/PICtR/reference/sketch_wrapper.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PICtR workflow wrapper — sketch_wrapper","text":"","code":"obj <- sketch_wrapper(channel = demo_lcmv,                       meta_data = demo_lcmv,                       n_sketch_cells = 5000,                       clst_algorithm = 1,                       ratio = TRUE,                       thresholding_method = \"otsu\",                        working_dir = tempdir()) #> Calculation of Ratio #> Warning: Feature names cannot have underscores ('_'), replacing with dashes ('-') #> Warning: Matrix compression performs poorly with non-integers. #> • Consider calling convert_matrix_type if a compressed integer matrix is intended. #> This message is displayed once every 8 hours. #> Your newly generated object will be saved under: /var/folders/zq/k957_k5s79v97_ptgc729fm1yy94mx/T//RtmpftyYMw/obj_sketched_non_projected.rds #> Sketching started... #> Finding variable features for layer counts #> Warning: NaNs produced #> Calcuating Leverage Score #> Attempting to cast layer counts to dgCMatrix #> Attempting to cast layer data to dgCMatrix #> Sketching is done #> Finding variable features for layer counts #> Warning: Chernobyl! trL>n 15 #> Warning: Chernobyl! trL>n 15 #> Warning: NaNs produced #> Centering and scaling data matrix #> Warning: Requested number is larger than the number of available items (15). Setting to 15. #> Warning: Requested number is larger than the number of available items (15). Setting to 15. #> Warning: Requested number is larger than the number of available items (15). Setting to 15. #> Warning: Requested number is larger than the number of available items (15). Setting to 15. #> Warning: Requested number is larger than the number of available items (15). Setting to 15. #> PC_ 1  #> Positive:  CD4, Ly6G, CD11b, CD90-1, CD8, CD11c, SSC.H, MHCII  #> Negative:  FSC.A, ratio, SSC.A, FSC.H, CD45-2, CD3, CD19  #> PC_ 2  #> Positive:  CD4, CD45-2, CD3, CD90-1, CD8, MHCII, CD19, ratio  #> Negative:  CD11b, SSC.H, Ly6G, SSC.A, FSC.H, CD11c, FSC.A  #> PC_ 3  #> Positive:  CD4, CD90-1, CD3, SSC.H, CD11b, SSC.A, FSC.H, CD8  #> Negative:  MHCII, CD19, ratio, CD45-2, FSC.A, CD11c, Ly6G  #> PC_ 4  #> Positive:  CD19, CD90-1, CD4, Ly6G, ratio, FSC.A, SSC.A, MHCII  #> Negative:  CD11c, CD8, CD45-2, CD11b, CD3, SSC.H, FSC.H  #> PC_ 5  #> Positive:  CD11c, MHCII, CD4, CD90-1, CD45-2, SSC.H, CD11b, SSC.A  #> Negative:  CD8, Ly6G, CD19, CD3, FSC.H, FSC.A, ratio  #> Computing nearest neighbor graph #> Computing SNN #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 5000 #> Number of edges: 164643 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.9193 #> Number of communities: 14 #> Elapsed time: 0 seconds #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 5000 #> Number of edges: 164643 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8813 #> Number of communities: 19 #> Elapsed time: 0 seconds #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 5000 #> Number of edges: 164643 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.8238 #> Number of communities: 24 #> Elapsed time: 0 seconds #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 5000 #> Number of edges: 164643 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.7740 #> Number of communities: 32 #> Elapsed time: 0 seconds #> Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck #>  #> Number of nodes: 5000 #> Number of edges: 164643 #>  #> Running Louvain algorithm... #> Maximum modularity in 10 random starts: 0.7367 #> Number of communities: 38 #> Elapsed time: 0 seconds #> Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric #> To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation' #> This message will be shown once per session #> UMAP will return its model #> 20:11:29 UMAP embedding parameters a = 0.9922 b = 1.112 #> 20:11:29 Read 5000 rows and found 15 numeric columns #> 20:11:29 Using Annoy for neighbor search, n_neighbors = 30 #> 20:11:29 Building Annoy index with metric = cosine, n_trees = 50 #> 0%   10   20   30   40   50   60   70   80   90   100% #> [----|----|----|----|----|----|----|----|----|----| #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> | #> 20:11:30 Writing NN index file to temp file /var/folders/zq/k957_k5s79v97_ptgc729fm1yy94mx/T//RtmpftyYMw/file90334509a953 #> 20:11:30 Searching Annoy index using 1 thread, search_k = 3000 #> 20:11:30 Annoy recall = 100% #> 20:11:31 Commencing smooth kNN distance calibration using 1 thread #>  with target n_neighbors = 30 #> 20:11:31 Initializing from normalized Laplacian + noise (using RSpectra) #> 20:11:31 Commencing optimization for 500 epochs, with 202814 positive edges #> 20:11:31 Using rng type: pcg #> 20:11:35 Optimization finished #> The object will be updated and saved"},{"path":"https://agshaas.github.io/PICtR/reference/split_plot_sketch.html","id":null,"dir":"Reference","previous_headings":"","what":"Split plot wrapper. — split_plot_sketch","title":"Split plot wrapper. — split_plot_sketch","text":"Dimensional reduction (UMAP) plot split given parameter. Per default returned split plots rasterized using geom_point_rast. Requires ggrastr.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/split_plot_sketch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split plot wrapper. — split_plot_sketch","text":"","code":"split_plot_sketch(obj, group_by = \"seurat_clusters\", split_by = \"ratio_anno\")"},{"path":"https://agshaas.github.io/PICtR/reference/split_plot_sketch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split plot wrapper. — split_plot_sketch","text":"obj Seurat object. group_by Parameter group plot . split_by Parameter split plot .","code":""},{"path":"https://agshaas.github.io/PICtR/reference/split_plot_sketch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split plot wrapper. — split_plot_sketch","text":"ggplot object","code":""},{"path":"https://agshaas.github.io/PICtR/reference/umap_rasterized.html","id":null,"dir":"Reference","previous_headings":"","what":"Rasterized UMAP — umap_rasterized","title":"Rasterized UMAP — umap_rasterized","text":"Wrapper function plot dimensional reduction plot colored clusters.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/umap_rasterized.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rasterized UMAP — umap_rasterized","text":"","code":"umap_rasterized(   data = obj,   group.by = \"seurat_clusters\",   raster.dpi = 500,   label = TRUE,   cols = pals::tol.rainbow(70),   umap1 = \"umap_1\",   umap2 = \"umap_2\",   reduction = \"umap\",   raster = TRUE )"},{"path":"https://agshaas.github.io/PICtR/reference/umap_rasterized.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rasterized UMAP — umap_rasterized","text":"data Seurat object. group.meta.data column group dimensional reduction plot , example clustering solution. raster.dpi Pixel resolution (numeric; default 500). label Boolean. Plot labels? cols Color palette. umap1 First UMAP dimension found meta.data. umap2 Second UMAP dimension found meta.data. reduction reduction use. raster Boolean. Rasterize plot?","code":""},{"path":"https://agshaas.github.io/PICtR/reference/umap_rasterized.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rasterized UMAP — umap_rasterized","text":"Plot","code":""},{"path":"https://agshaas.github.io/PICtR/reference/wrapper_for_plots.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot wrapper function. — wrapper_for_plots","title":"Plot wrapper function. — wrapper_for_plots","text":"wrapper function plots often used exploratory analysis within Seurat framework (https://satijalab.org/seurat/). Includes FeaturePlot, DimPlot different parameters, ratio_cluster_plot.","code":""},{"path":"https://agshaas.github.io/PICtR/reference/wrapper_for_plots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot wrapper function. — wrapper_for_plots","text":"","code":"wrapper_for_plots(   obj = obj,   feature_plot = TRUE,   cluster_plot = TRUE,   meta_list = list(\"ratio_anno\"),   cluster_handle = \"sketch_snn_res\",   feature_plot_colors = pals::parula(1000),   ratio_plot_color = c(Ratio_low = \"dodgerblue2\", Ratio_high = \"gold2\"),   reduction = \"umap\",   alpha = 1,   raster = F,   label_size = 3,   label_box = FALSE,   assay = \"sketch\" )"},{"path":"https://agshaas.github.io/PICtR/reference/wrapper_for_plots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot wrapper function. — wrapper_for_plots","text":"obj Seurat object. feature_plot Boolean. TRUE indicates UMAP colored features (see FeaturePlot) cluster_plot Boolean. TRUE indicates UMAP colored different cluster resolutions stored cluster_handle. meta_list List meta.data columns color DimPlot . Can numeric generate FeaturePlot class character factor DimPlot. cluster_handle Prefix clustering solutions meta.data slot. feature_plot_colors Color palette FeaturePlot. ratio_plot_color Color palette ratio_cluster_plot. reduction Reduction use plotting, example UMAP. alpha Alpha value plotting. raster Convert points raster format. TRUE plot rasterized raster.dpi=c(512, 512). Requires ggrastr. label_size Size labels plotted within embedding. label_box Plot boxes around labels color cluster. assay Seurat assay (default FACS).","code":""},{"path":"https://agshaas.github.io/PICtR/reference/wrapper_for_plots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot wrapper function. — wrapper_for_plots","text":"list requested plots.","code":""}]
