# PICtR

This is the computational workflow to analyse physically interacting
cells (PICs) in flow cytometry data using R.

## Installation

First, please install [BPCells](https://github.com/bnprks/BPCells).
Next, PICtR can be installed using:

``` r
install.packages("PICtR", repos = c("https://agshaas.r-universe.dev", "https://cloud.r-project.org"))
```

or directly from GitHub using:

``` r
if (!require("remotes", quietly = TRUE)) {
  install.packages("remotes")
}

remotes::install_github("agSHaas/PICtR")
```

## Workflow

Please refer to the
[Vignette](https://agshaas.github.io/PICtR/articles/PICtR.html) and the
Method section of our manuscript for a comprehensive description of the
analysis pipeline.

## Demo Data

The package comprises a demo data set from LCMV infected mice. Data was
analysed using high parametric spectral flow cytometry and can be loaded
with `data(demo_lcmv)`. See
[`?demo_lcmv`](https://agshaas.github.io/PICtR/reference/demo_lcmv.md)
for details.

## Dependencies

The core of this framework relies on [Seurat version
5](https://github.com/satijalab/seurat) and
[BPCells](https://github.com/bnprks/BPCells). Please make sure that R is
operating in version 4.3 or higher.

Some packages are not necessarily required, but expand the functionality
of PICtR. Consider installing:

- [flowMeans](https://www.bioconductor.org/packages/release/bioc/html/flowMeans.html)  
- [dbscan](https://github.com/mhahsler/dbscan)  
- [Spectre](https://github.com/ImmuneDynamics/Spectre)
- [ComplexHeatmap](https://www.bioconductor.org/packages/release/bioc/html/ComplexHeatmap.html)  
- [cytoMEM](https://www.bioconductor.org/packages/release/bioc/html/cytoMEM.html)  
- [autothresholdr](https://github.com/rorynolan/autothresholdr)

## Citation

If you use PICtR in your work, please cite

> Vonficht, Jopp-Saile, Yousefian, Flore et al.Â Ultra-high-scale
> cytometry-based cellular interaction mapping. *Nature Methods* (2025).
> <https://doi.org/10.1038/s41592-025-02744-w>

## Version

Current version 1.0.1

# Package index

## All functions

- [`MEM_heatmap()`](https://agshaas.github.io/PICtR/reference/MEM_heatmap.md)
  : Marker Enrichment Modeling (MEM) Heatmap.
- [`calculateThreshold()`](https://agshaas.github.io/PICtR/reference/calculateThreshold.md)
  : Threshold calculation
- [`demo_lcmv`](https://agshaas.github.io/PICtR/reference/demo_lcmv.md)
  : Demo data set
- [`predict_data()`](https://agshaas.github.io/PICtR/reference/predict_data.md)
  : Cluster label prediction
- [`ratio_cluster_plot()`](https://agshaas.github.io/PICtR/reference/ratio_cluster_plot.md)
  : Ratio cluster plot.
- [`save.obj()`](https://agshaas.github.io/PICtR/reference/save.obj.md)
  : Save Seurat object
- [`save.plot()`](https://agshaas.github.io/PICtR/reference/save.plot.md)
  : Save plot
- [`select_dbt()`](https://agshaas.github.io/PICtR/reference/select_dbt.md)
  : Selection of clusters containing physically interacting cells.
- [`sketch_wrapper()`](https://agshaas.github.io/PICtR/reference/sketch_wrapper.md)
  : PICtR workflow wrapper
- [`split_plot_sketch()`](https://agshaas.github.io/PICtR/reference/split_plot_sketch.md)
  : Split plot wrapper.
- [`umap_rasterized()`](https://agshaas.github.io/PICtR/reference/umap_rasterized.md)
  : Rasterized UMAP
- [`wrapper_for_plots()`](https://agshaas.github.io/PICtR/reference/wrapper_for_plots.md)
  : Plot wrapper function.

# Articles

### All vignettes

- [PICtR: Physically Interacting Cell toolkit for
  R](https://agshaas.github.io/PICtR/articles/PICtR.md):
